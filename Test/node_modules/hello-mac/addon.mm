#import "usbNotifier.h"
#include <node.h>
#include <string>
#include <iostream>
#import <Foundation/Foundation.h>

using namespace v8;
using namespace std;

usbNotifier* notifier;

void Run(const FunctionCallbackInfo<Value>& args) {
	NSLog(@"Run task");
	//NSLog(@"%p", args);
	notifier = [[usbNotifier alloc] init];
	[notifier runTask:args];
	//[usbNotifier runTask:args];

	//args.GetReturnValue().Set(String::NewFromUtf8(isolate, "USBNOtify Start"));
}

void Stop(const FunctionCallbackInfo<Value>& args) {

	[notifier stopTask:args];
	//[notifier unpack_location:args];
	//args.GetReturnValue().Set(String::NewFromUtf8(isolate, "USBNOtify Stop"));

}

void Init(Handle<Object> exports) {
  NODE_SET_METHOD(exports, "run", Run);
  NODE_SET_METHOD(exports, "stop", Stop);
}

NODE_MODULE(addon, Init)
